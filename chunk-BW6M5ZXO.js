import{a as D}from"./chunk-ZDQP24ZT.js";import{a as z,b as P,c as p,d as A,e as R,j as V,l as N,m as G,t as H,v as j}from"./chunk-QZFKTEUQ.js";import{i as L,j as w}from"./chunk-U5M4MCHP.js";import{m as I}from"./chunk-KN5TDDFY.js";import"./chunk-QA474ISG.js";import{Ab as m,Kb as _,Lb as f,Ra as s,Rb as C,Tb as o,Ub as E,_ as y,ga as c,gb as k,ha as u,rb as d,sb as g,v as T,xb as M,yb as e,zb as i}from"./chunk-QAY2GC3V.js";import"./chunk-7CGTOI24.js";function Z(a,n){a&1&&o(0," Email is required ")}function J(a,n){a&1&&o(0," Please enter a valid email address ")}function U(a,n){if(a&1&&(e(0,"p",8),d(1,Z,1,0),d(2,J,1,0),i()),a&2){let t,r,l=f();s(),g(!((t=l.signinForm.get("email"))==null||t.errors==null)&&t.errors.required?1:-1),s(),g(!((r=l.signinForm.get("email"))==null||r.errors==null)&&r.errors.email?2:-1)}}function W(a,n){a&1&&o(0," Password is required ")}function $(a,n){a&1&&o(0," Password must be at least 6 characters long ")}function K(a,n){if(a&1&&(e(0,"p",8),d(1,W,1,0),d(2,$,1,0),i()),a&2){let t,r,l=f();s(),g(!((t=l.signinForm.get("password"))==null||t.errors==null)&&t.errors.required?1:-1),s(),g(!((r=l.signinForm.get("password"))==null||r.errors==null)&&r.errors.minlength?2:-1)}}function Q(a,n){a&1&&(c(),e(0,"svg",20),m(1,"circle",21)(2,"path",22),i(),o(3," Signing in... "))}function X(a,n){a&1&&(c(),e(0,"svg",23),m(1,"path",24),i(),o(2," Sign in to your account "))}function Y(a,n){if(a&1&&(e(0,"div",18)(1,"div",25)(2,"div",26),c(),e(3,"svg",27),m(4,"path",28),i()(),u(),e(5,"div",29)(6,"p",30),o(7),i()()()()),a&2){let t=f();s(7),E(t.errorMessage)}}function ee(a,n){if(a&1&&(e(0,"div",19)(1,"div",25)(2,"div",26),c(),e(3,"svg",31),m(4,"path",32),i()(),u(),e(5,"div",29)(6,"p",33),o(7),i()()()()),a&2){let t=f();s(7),E(t.successMessage)}}var F=class a{isLoading=!1;errorMessage;successMessage;authService=y(D);router=y(L);fb=y(H);ngOnInit(){let n=localStorage.getItem("token"),t=sessionStorage.getItem("token");(n||t)&&this.router.navigate(["/app/home"]),this.initializeRememberMe()}signinForm=this.fb.group({email:["",[p.required,p.email,p.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],password:["",[p.required,p.minLength(6)]],rememberMe:[!1]});onSubmit(){if(this.handlebeforeSubmit(),this.signinForm.valid){let n=this.signinForm.get("email")?.value,t=this.signinForm.get("password")?.value;if(n&&t){let r={email:n,password:t};this.authService.signin(r).subscribe({next:l=>{this.signinForm.get("rememberMe")?.value?localStorage.setItem("token",l.token):(sessionStorage.setItem("token",l.token),localStorage.removeItem("token")),l.user&&localStorage.setItem("user",JSON.stringify(l.user)),this.signinForm.get("rememberMe")?.value?(localStorage.setItem("rememberMe","true"),localStorage.setItem("rememberedEmail",n)):(localStorage.removeItem("rememberMe"),localStorage.removeItem("rememberedEmail")),this.handleSuccessMessage()},error:l=>{console.error("Signin error:",l),this.handleErrorMessage(l)},complete:()=>{this.handleResetForm(),this.isLoading=!1}})}else this.isLoading=!1,this.errorMessage="Please fill in all required fields."}else this.isLoading=!1,this.signinForm.markAllAsTouched()}handlebeforeSubmit(){this.isLoading=!0,this.errorMessage="",this.successMessage="",this.signinForm.markAllAsTouched()}handleErrorMessage(n){this.isLoading=!1,n.status===401?this.errorMessage="Invalid email or password. Please check your credentials and try again.":n.status===403?this.errorMessage="Account is disabled. Please contact support.":n.status===404?this.errorMessage="User not found. Please check your email address.":n.status===429?this.errorMessage="Too many login attempts. Please try again later.":n.status===500?this.errorMessage="Server error. Please try again later.":this.errorMessage="An error occurred while signing in. Please try again."}handleSuccessMessage(){this.successMessage="Successfully signed in! Redirecting...",T(2e3).subscribe(()=>{this.router.navigate(["/app/home"])})}handleResetForm(){this.successMessage||(this.signinForm.reset(),this.initializeRememberMe())}initializeRememberMe(){let n=localStorage.getItem("rememberMe"),t=localStorage.getItem("rememberedEmail");n==="true"&&t&&this.signinForm.patchValue({email:t,rememberMe:!0})}onRememberMeChange(){let n=this.signinForm.get("rememberMe")?.value,t=this.signinForm.get("email")?.value;n?t&&(localStorage.setItem("rememberMe","true"),localStorage.setItem("rememberedEmail",t)):(localStorage.removeItem("rememberMe"),localStorage.removeItem("rememberedEmail"))}onEmailChange(){let n=this.signinForm.get("rememberMe")?.value,t=this.signinForm.get("email")?.value;n&&t&&localStorage.setItem("rememberedEmail",t)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=k({type:a,selectors:[["app-signin-form"]],decls:35,vars:15,consts:[[1,"space-y-6",3,"ngSubmit","formGroup"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark-text-white"],[1,"text-red-500"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"],["type","email","formControlName","email","name","email","id","email","placeholder","Enter your email address",1,"pl-10","bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-2","focus:ring-green-500","focus:border-green-500","block","w-full","p-2.5","dark-bg-gray-600","dark-border-gray-500","dark-placeholder-gray-400","dark-text-white","transition-colors","duration-200",3,"input"],[1,"mt-1","text-sm","text-red-600","dark-text-red-400"],["for","password",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark-text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],["type","password","formControlName","password","name","password","id","password","placeholder","Enter your password",1,"pl-10","bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-2","focus:ring-green-500","focus:border-green-500","block","w-full","p-2.5","dark-bg-gray-600","dark-border-gray-500","dark-placeholder-gray-400","dark-text-white","transition-colors","duration-200"],[1,"flex","items-center","justify-between"],[1,"flex","items-center"],["id","remember","type","checkbox","formControlName","rememberMe",1,"w-4","h-4","text-green-600","bg-gray-100","border-gray-300","rounded","focus:ring-green-500","dark-focus:ring-green-600","dark-ring-offset-gray-800","focus:ring-2","dark-bg-gray-700","dark-border-gray-600",3,"change"],["for","remember",1,"ml-2","text-sm","font-medium","text-gray-900","dark-text-gray-300"],["routerLink","/auth/forgot-password",1,"text-sm","font-medium","text-green-600","hover:text-green-500","dark-text-green-400","dark-hover:text-green-300","transition-colors","duration-200"],["type","submit",1,"w-full","flex","justify-center","items-center","px-4","py-3","border","border-transparent","text-sm","font-medium","rounded-lg","text-white","bg-green-600","hover:bg-green-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-500","disabled:opacity-50","disabled:cursor-not-allowed","transition-all","duration-200","transform","hover:scale-[1.02]","active:scale-[0.98]",3,"disabled"],[1,"bg-red-50","dark-bg-red-900/20","border","border-red-200","dark-border-red-800","rounded-lg","p-4"],[1,"bg-green-50","dark-bg-green-900/20","border","border-green-200","dark-border-green-800","rounded-lg","p-4"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"],[1,"flex"],[1,"flex-shrink-0"],["viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","text-red-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"ml-3"],[1,"text-sm","text-red-800","dark-text-red-200"],["viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","text-green-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"text-sm","text-green-800","dark-text-green-200"]],template:function(t,r){if(t&1&&(e(0,"form",0),_("ngSubmit",function(){return r.onSubmit()}),e(1,"div")(2,"label",1),o(3," Email Address "),e(4,"span",2),o(5,"*"),i()(),e(6,"div",3)(7,"div",4),c(),e(8,"svg",5),m(9,"path",6),i()(),u(),e(10,"input",7),_("input",function(){return r.onEmailChange()}),i()(),d(11,U,3,2,"p",8),i(),e(12,"div")(13,"label",9),o(14," Password "),e(15,"span",2),o(16,"*"),i()(),e(17,"div",3)(18,"div",4),c(),e(19,"svg",5),m(20,"path",10),i()(),u(),m(21,"input",11),i(),d(22,K,3,2,"p",8),i(),e(23,"div",12)(24,"div",13)(25,"input",14),_("change",function(){return r.onRememberMeChange()}),i(),e(26,"label",15),o(27," Remember me "),i()(),e(28,"a",16),o(29," Forgot password? "),i()(),e(30,"button",17),d(31,Q,4,0)(32,X,3,0),i(),d(33,Y,8,1,"div",18),d(34,ee,8,1,"div",19),i()),t&2){let l,h,v,x,b,S;M("formGroup",r.signinForm),s(10),C("border-red-500",((l=r.signinForm.get("email"))==null?null:l.invalid)&&((l=r.signinForm.get("email"))==null?null:l.touched))("border-green-500",((h=r.signinForm.get("email"))==null?null:h.valid)&&((h=r.signinForm.get("email"))==null?null:h.touched)),s(),g((v=r.signinForm.get("email"))!=null&&v.invalid&&((v=r.signinForm.get("email"))!=null&&v.touched)?11:-1),s(10),C("border-red-500",((x=r.signinForm.get("password"))==null?null:x.invalid)&&((x=r.signinForm.get("password"))==null?null:x.touched))("border-green-500",((b=r.signinForm.get("password"))==null?null:b.valid)&&((b=r.signinForm.get("password"))==null?null:b.touched)),s(),g((S=r.signinForm.get("password"))!=null&&S.invalid&&((S=r.signinForm.get("password"))!=null&&S.touched)?22:-1),s(8),M("disabled",r.isLoading||r.signinForm.invalid),s(),g(r.isLoading?31:32),s(2),g(r.errorMessage?33:-1),s(),g(r.successMessage?34:-1)}},dependencies:[j,V,P,z,A,R,N,G,w,I],encapsulation:2})};var q=class a{static \u0275fac=function(t){return new(t||a)};static \u0275cmp=k({type:a,selectors:[["app-signin"]],decls:33,vars:0,consts:[[1,"min-h-screen","bg-gradient-to-br","from-green-50","via-white","to-blue-50","dark-from-gray-900","dark-via-gray-800","dark-to-gray-900","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"text-center"],[1,"mx-auto","h-16","w-16","bg-green-100","dark-bg-green-900/20","rounded-full","flex","items-center","justify-center","mb-6","shadow-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-8","w-8","text-green-600","dark-text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"text-3xl","font-bold","text-gray-900","dark-text-white","mb-2"],[1,"text-gray-600","dark-text-gray-400"],[1,"bg-white","dark-bg-gray-800","rounded-2xl","shadow-2xl","border","border-gray-200","dark-border-gray-700","p-8","space-y-6"],[1,"relative"],[1,"absolute","inset-0","flex","items-center"],[1,"w-full","border-t","border-gray-300","dark-border-gray-600"],[1,"relative","flex","justify-center","text-sm"],[1,"px-4","bg-white","dark-bg-gray-800","text-gray-500","dark-text-gray-400"],[1,"text-sm","text-gray-600","dark-text-gray-400"],["routerLink","/auth/signup",1,"font-medium","text-green-600","dark-text-green-400","hover:text-green-500","dark-hover:text-green-300","transition-colors","duration-200","ml-1"],[1,"text-center","space-y-4"],[1,"flex","justify-center","space-x-6","text-sm"],["href","#",1,"text-gray-500","dark-text-gray-400","hover:text-gray-700","dark-hover:text-gray-300","transition-colors","duration-200"],[1,"text-xs","text-gray-400","dark-text-gray-500"]],template:function(t,r){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),c(),e(4,"svg",4),m(5,"path",5),i()(),u(),e(6,"h2",6),o(7," Welcome back "),i(),e(8,"p",7),o(9," Sign in to your FreshCart account "),i()(),e(10,"div",8),m(11,"app-signin-form"),e(12,"div",9)(13,"div",10),m(14,"div",11),i(),e(15,"div",12)(16,"span",13),o(17,"New to FreshCart?"),i()()(),e(18,"div",2)(19,"p",14),o(20," Don't have an account? "),e(21,"a",15),o(22," Create one now "),i()()()(),e(23,"div",16)(24,"div",17)(25,"a",18),o(26," Privacy Policy "),i(),e(27,"a",18),o(28," Terms of Service "),i(),e(29,"a",18),o(30," Help Center "),i()(),e(31,"p",19),o(32," \xA9 2025 FreshCart. All rights reserved. "),i()()()())},dependencies:[F,w],encapsulation:2})};export{q as Signin};
